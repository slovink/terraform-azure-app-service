<!-- This file was automatically generated by the `geine`. Make all changes to `README.yaml` and run `make readme` to rebuild this file. -->

<p align="center"> <img src="https://user-images.githubusercontent.com/50652676/62349836-882fef80-b51e-11e9-99e3-7b974309c7e3.png" width="100" height="100"></p>


<h1 align="center">
    Terraform AZURE APP SERVICE
</h1>

<p align="center" style="font-size: 1.2rem;">
    Terraform module to create app-service resource on AZURE.
     </p>

<p align="center">

<a href="https://www.terraform.io">
  <img src="https://img.shields.io/badge/Terraform-v1.7.4-green" alt="Terraform">
</a>
<a href="https://github.com/slovink/terraform-azure-app-service/blob/master/LICENSE">
  <img src="https://img.shields.io/badge/License-APACHE-blue.svg" alt="Licence">
</a>


## Prerequisites

This module has a few dependencies:

- [Terraform 1.x.x](https://learn.hashicorp.com/terraform/getting-started/install.html)
- [Go](https://golang.org/doc/install)
- [github.com/stretchr/testify/assert](https://github.com/stretchr/testify)
- [github.com/gruntwork-io/terratest/modules/terraform](https://github.com/gruntwork-io/terratest)







## Examples


**IMPORTANT:** Since the `master` branch used in `source` varies based on new modifications, we suggest that you use the release versions [here](https://github.com/slovink/terraform-azure-app-service/releases).


### Simple Example
Here is an example of how you can use this module in your inventory structure:
  #### Default App Service with NODE
```hcl
module "app-service" {
  source              = "git@github.com:slovink/terraform-azure-app-service.git?ref=1.0.0"
  enabled             = true
  name                = "app"
  environment         = "teting"
  label_order         = ["name", "environment", ]
  resource_group_name = module.resource_group.resource_group_name
  location            = module.resource_group.resource_group_location

  service_plan = {
    kind = "Windows"
    size = "S1"
    tier = "Free"
  }

  app_service_name       = "test-app-service"
  enable_client_affinity = true
  enable_https           = true

  site_config = {
    use_32_bit_worker_process = true
    windows_fx_version        = "node|18-lts"
  }

  app_settings = {
    WEBSITE_NODE_DEFAULT_VERSION = "~16"
  }
}





## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| active\_directory\_auth\_setttings | Acitve directory authentication provider settings for app service | `any` | `{}` | no |
| addon\_resource\_group\_name | The name of the addon vnet resource group | `string` | `""` | no |
| addon\_vent\_link | The name of the addon vnet | `bool` | `false` | no |
| addon\_virtual\_network\_id | The name of the addon vnet link vnet id | `string` | `""` | no |
| app\_insights\_name | The Name of the application insights | `string` | `""` | no |
| app\_service\_name | Specifies the name of the App Service. | `string` | `""` | no |
| app\_settings | A key-value pair of App Settings. | `map(string)` | `{}` | no |
| application\_insights\_enabled | Specify the Application Insights use for this App Service | `bool` | `true` | no |
| application\_insights\_id | Resource ID of the existing Application Insights | `any` | `null` | no |
| application\_insights\_type | Specifies the type of Application Insights to create. Valid values are `ios` for iOS, `java` for Java web, `MobileCenter` for App Center, `Node.JS` for Node.js, `other` for General, `phone` for Windows Phone, `store` for Windows Store and `web` for ASP.NET. | `string` | `"web"` | no |
| connection\_strings | Connection strings for App Service | `list(map(string))` | `[]` | no |
| default\_auth\_provider | The default provider to use when multiple providers have been set up. Possible values are `AzureActiveDirectory`, `Facebook`, `Google`, `MicrosoftAccount` and `Twitter` | `string` | `"AzureActiveDirectory"` | no |
| disable\_ip\_masking | By default the real client ip is masked as `0.0.0.0` in the logs. Use this argument to disable masking and log the real client ip | `bool` | `false` | no |
| enable\_auth\_settings | Specifies the Authenication enabled or not | `bool` | `false` | no |
| enable\_client\_affinity | Should the App Service send session affinity cookies, which route client requests in the same session to the same instance? | `bool` | `false` | no |
| enable\_client\_certificate | Does the App Service require client certificates for incoming requests | `bool` | `false` | no |
| enable\_https | Can the App Service only be accessed via HTTPS? | `bool` | `false` | no |
| enable\_private\_endpoint | enable or disable private endpoint to storage account | `bool` | `false` | no |
| enable\_vnet\_integration | Manages an App Service Virtual Network Association | `bool` | `false` | no |
| enabled | Set to false to prevent the module from creating any resources. | `bool` | `true` | no |
| environment | Environment (e.g. `prod`, `dev`, `staging`). | `string` | `""` | no |
| existing\_private\_dns\_zone | Name of the existing private DNS zone | `string` | `null` | no |
| existing\_private\_dns\_zone\_resource\_group\_name | The name of the existing resource group | `string` | `""` | no |
| identity\_ids | Specifies a list of user managed identity ids to be assigned | `any` | `null` | no |
| integration\_subnet\_id | The resource ID of the subnet | `string` | `null` | no |
| ips\_allowed | IPs restriction for App Service to allow specific IP addresses or ranges | `list(string)` | `[]` | no |
| label\_order | Label order, e.g. sequence of application name and environment `name`,`environment`,'attribute' [`webserver`,`qa`,`devops`,`public`,] . | `list(any)` | `[]` | no |
| location | Location where resource group will be created. | `string` | `null` | no |
| managedby | ManagedBy, eg ''. | `string` | `""` | no |
| name | Name  (e.g. `app` or `cluster`). | `string` | `""` | no |
| repository | Terraform current module repo | `string` | `""` | no |
| resource\_group\_name | A container that holds related resources for an Azure solution | `string` | `""` | no |
| retention\_in\_days | Specifies the retention period in days. Possible values are `30`, `60`, `90`, `120`, `180`, `270`, `365`, `550` or `730` | `number` | `90` | no |
| service\_plan | Definition of the dedicated plan to use | <pre>object({<br>    kind             = string<br>    size             = string<br>    capacity         = optional(number)<br>    tier             = string<br>    per_site_scaling = optional(bool)<br>  })</pre> | n/a | yes |
| site\_config | Site configuration for Application Service | `any` | `{}` | no |
| storage\_mounts | Storage account mount points for App Service | `list(map(string))` | `[]` | no |
| subnet\_id | The resource ID of the subnet | `string` | `null` | no |
| subnet\_ids\_allowed | Allow Specific Subnets for App Service | `list(string)` | `[]` | no |
| tags | A map of tags to add to all resources | `map(string)` | `{}` | no |
| token\_store\_enabled | If enabled the module will durably store platform-specific security tokens that are obtained during login flows | `bool` | `false` | no |
| unauthenticated\_client\_action | The action to take when an unauthenticated client attempts to access the app. Possible values are `AllowAnonymous` and `RedirectToLoginPage` | `string` | `"RedirectToLoginPage"` | no |
| virtual\_network\_id | The name of the virtual network | `string` | `null` | no |

## Outputs

| Name | Description |
|------|-------------|
| custom\_domain\_verification\_id | An identifier used by App Service to perform domain ownership verification via DNS TXT record. |
| default\_site\_hostname | The Default Hostname associated with the App Service - such as mysite.azurewebsites.net |
| id | The ID of the App Service. |
| maximum\_number\_of\_workers | The maximum number of workers supported with the App Service Plan's sku. |
| outbound\_ip\_address\_list | A list of outbound IP addresses - such as ['52.23.25.3', '52.143.43.12'] |
| outbound\_ip\_addresses | A comma separated list of outbound IP addresses - such as 52.23.25.3,52.143.43.12 |
| possible\_outbound\_ip\_address\_list | A list of outbound IP addresses - such as ['52.23.25.3', '52.143.43.12', '52.143.43.17'] - not all of which are necessarily in use. Superset of outbound\_ip\_address\_list |
| possible\_outbound\_ip\_addresses | A comma separated list of outbound IP addresses - such as 52.23.25.3,52.143.43.12,52.143.43.17 - not all of which are necessarily in use. Superset of outbound\_ip\_addresses |
| service\_plan\_id | The ID of the App Service Plan component. |
| site\_credential | A site\_credential block as defined below, which contains the site-level credentials used to publish to this App Service. |
| source\_control | A source\_control block as defined below, which contains the Source Control information when scm\_type is set to LocalGit. |




## Testing
In this module testing is performed with [terratest](https://github.com/gruntwork-io/terratest) and it creates a small piece of infrastructure, matches the output like ARN, ID and Tags name etc and destroy infrastructure in your AWS account. This testing is written in GO, so you need a [GO environment](https://golang.org/doc/install) in your system.

You need to run the following command in the testing folder:
```hcl
  go test -run Test
```

# Examples
For detailed examples on how to use this module, please refer to the [example](https://github.com/slovink/terraform-azure-app-service/blob/master/_example) directory within this repository.

# License
This Terraform module is provided under the **MIT** License. Please see the [LICENSE](https://github.com/slovink/terraform-azure-app-service/blob/master/LICENSE) file for more details.

## Feedback
If you come accross a bug or have any feedback, please log it in our [issue tracker](https://github.com/slovink/terraform-azure-app-service/issues), or feel free to drop us an email at [contact@slovink.com](contact@slovink.com).

If you have found it worth your time, go ahead and give us a ★ on [our GitHub](https://github.com/slovink/terraform-azure-app-service)!

## About us

At [slovink][website], we offer expert guidance, implementation support and services to help organisations accelerate their journey to the cloud. Our services include docker and container orchestration, cloud migration and adoption, infrastructure automation, application modernisation and remediation, and performance engineering.

<p align="center">We are <b> The Cloud Experts!</b></p>
<hr />
<p align="center">We ❤️  <a href="https://github.com/slovink">Open Source</a> and you can check out <a href="https://github.com/slovink">our other modules</a> to get help with your new Cloud ideas.</p>


<!-- BEGIN_TF_DOCS -->
## Requirements

| Name | Version |
|------|---------|
| <a name="requirement_terraform"></a> [terraform](#requirement\_terraform) | >= 1.7.4 |
| <a name="requirement_azurerm"></a> [azurerm](#requirement\_azurerm) | >=3.87.0 |

## Providers

| Name | Version |
|------|---------|
| <a name="provider_azurerm"></a> [azurerm](#provider\_azurerm) | >=3.87.0 |

## Modules

| Name | Source | Version |
|------|--------|---------|
| <a name="module_labels"></a> [labels](#module\_labels) | git@github.com:slovink/terraform-azure-labels.git | 1.0.0 |

## Resources

| Name | Type |
|------|------|
| [azurerm_app_service.main](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service) | resource |
| [azurerm_app_service_plan.main](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service_plan) | resource |
| [azurerm_app_service_virtual_network_swift_connection.main](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service_virtual_network_swift_connection) | resource |
| [azurerm_application_insights.main](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/application_insights) | resource |
| [azurerm_private_dns_zone.dnszone](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/private_dns_zone) | resource |
| [azurerm_private_dns_zone_virtual_network_link.vent-link](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/private_dns_zone_virtual_network_link) | resource |
| [azurerm_private_endpoint.pep](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/private_endpoint) | resource |
| [azurerm_application_insights.main](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/application_insights) | data source |
| [azurerm_client_config.main](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/client_config) | data source |

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| <a name="input_active_directory_auth_setttings"></a> [active\_directory\_auth\_setttings](#input\_active\_directory\_auth\_setttings) | Acitve directory authentication provider settings for app service | `any` | `{}` | no |
| <a name="input_app_insights_name"></a> [app\_insights\_name](#input\_app\_insights\_name) | The Name of the application insights | `string` | `""` | no |
| <a name="input_app_settings"></a> [app\_settings](#input\_app\_settings) | A key-value pair of App Settings. | `map(string)` | `{}` | no |
| <a name="input_application_insights_enabled"></a> [application\_insights\_enabled](#input\_application\_insights\_enabled) | Specify the Application Insights use for this App Service | `string` | `true` | no |
| <a name="input_application_insights_id"></a> [application\_insights\_id](#input\_application\_insights\_id) | Resource ID of the existing Application Insights | `string` | `null` | no |
| <a name="input_application_insights_type"></a> [application\_insights\_type](#input\_application\_insights\_type) | Specifies the type of Application Insights to create. Valid values are `ios` for iOS, `java` for Java web, `MobileCenter` for App Center, `Node.JS` for Node.js, `other` for General, `phone` for Windows Phone, `store` for Windows Store and `web` for ASP.NET. | `string` | `"web"` | no |
| <a name="input_connection_strings"></a> [connection\_strings](#input\_connection\_strings) | Connection strings for App Service | `list(map(string))` | `[]` | no |
| <a name="input_default_auth_provider"></a> [default\_auth\_provider](#input\_default\_auth\_provider) | The default provider to use when multiple providers have been set up. Possible values are `AzureActiveDirectory`, `Facebook`, `Google`, `MicrosoftAccount` and `Twitter` | `string` | `"AzureActiveDirectory"` | no |
| <a name="input_disable_ip_masking"></a> [disable\_ip\_masking](#input\_disable\_ip\_masking) | By default the real client ip is masked as `0.0.0.0` in the logs. Use this argument to disable masking and log the real client ip | `string` | `false` | no |
| <a name="input_enable_auth_settings"></a> [enable\_auth\_settings](#input\_enable\_auth\_settings) | Specifies the Authenication enabled or not | `string` | `false` | no |
| <a name="input_enable_client_affinity"></a> [enable\_client\_affinity](#input\_enable\_client\_affinity) | Should the App Service send session affinity cookies, which route client requests in the same session to the same instance? | `string` | `false` | no |
| <a name="input_enable_client_certificate"></a> [enable\_client\_certificate](#input\_enable\_client\_certificate) | Does the App Service require client certificates for incoming requests | `string` | `false` | no |
| <a name="input_enable_https"></a> [enable\_https](#input\_enable\_https) | Can the App Service only be accessed via HTTPS? | `string` | `false` | no |
| <a name="input_enable_private_endpoint"></a> [enable\_private\_endpoint](#input\_enable\_private\_endpoint) | enable or disable private endpoint to storage account | `bool` | `false` | no |
| <a name="input_enabled"></a> [enabled](#input\_enabled) | Set to false to prevent the module from creating any resources. | `bool` | `true` | no |
| <a name="input_environment"></a> [environment](#input\_environment) | Environment (e.g. `prod`, `dev`, `staging`). | `string` | `""` | no |
| <a name="input_existing_private_dns_zone"></a> [existing\_private\_dns\_zone](#input\_existing\_private\_dns\_zone) | Name of the existing private DNS zone | `string` | `null` | no |
| <a name="input_existing_private_dns_zone_resource_group_name"></a> [existing\_private\_dns\_zone\_resource\_group\_name](#input\_existing\_private\_dns\_zone\_resource\_group\_name) | The name of the existing resource group | `string` | `""` | no |
| <a name="input_identity_ids"></a> [identity\_ids](#input\_identity\_ids) | Specifies a list of user managed identity ids to be assigned | `string` | `null` | no |
| <a name="input_integration_subnet_id"></a> [integration\_subnet\_id](#input\_integration\_subnet\_id) | The resource ID of the subnet | `string` | `null` | no |
| <a name="input_ips_allowed"></a> [ips\_allowed](#input\_ips\_allowed) | IPs restriction for App Service to allow specific IP addresses or ranges | `list(string)` | `[]` | no |
| <a name="input_label_order"></a> [label\_order](#input\_label\_order) | Label order, e.g. sequence of application name and environment `name`,`environment`,'attribute' [`webserver`,`qa`,`devops`,`public`,] . | `list(any)` | `[]` | no |
| <a name="input_location"></a> [location](#input\_location) | Location where resource group will be created. | `string` | `null` | no |
| <a name="input_name"></a> [name](#input\_name) | Name  (e.g. `app` or `cluster`). | `string` | `""` | no |
| <a name="input_repository"></a> [repository](#input\_repository) | Terraform current module repo | `string` | `""` | no |
| <a name="input_resource_group_name"></a> [resource\_group\_name](#input\_resource\_group\_name) | A container that holds related resources for an Azure solution | `string` | `""` | no |
| <a name="input_retention_in_days"></a> [retention\_in\_days](#input\_retention\_in\_days) | Specifies the retention period in days. Possible values are `30`, `60`, `90`, `120`, `180`, `270`, `365`, `550` or `730` | `string` | `90` | no |
| <a name="input_service_plan"></a> [service\_plan](#input\_service\_plan) | Definition of the dedicated plan to use | <pre>object({<br>    kind             = string<br>    size             = string<br>    capacity         = optional(number)<br>    tier             = string<br>    per_site_scaling = optional(bool)<br>  })</pre> | n/a | yes |
| <a name="input_site_config"></a> [site\_config](#input\_site\_config) | Site configuration for Application Service | `any` | `{}` | no |
| <a name="input_storage_mounts"></a> [storage\_mounts](#input\_storage\_mounts) | Storage account mount points for App Service | `list(map(string))` | `[]` | no |
| <a name="input_subnet_id"></a> [subnet\_id](#input\_subnet\_id) | The resource ID of the subnet | `string` | `null` | no |
| <a name="input_subnet_ids_allowed"></a> [subnet\_ids\_allowed](#input\_subnet\_ids\_allowed) | Allow Specific Subnets for App Service | `list(string)` | `[]` | no |
| <a name="input_token_store_enabled"></a> [token\_store\_enabled](#input\_token\_store\_enabled) | If enabled the module will durably store platform-specific security tokens that are obtained during login flows | `string` | `false` | no |
| <a name="input_unauthenticated_client_action"></a> [unauthenticated\_client\_action](#input\_unauthenticated\_client\_action) | The action to take when an unauthenticated client attempts to access the app. Possible values are `AllowAnonymous` and `RedirectToLoginPage` | `string` | `"RedirectToLoginPage"` | no |
| <a name="input_virtual_network_id"></a> [virtual\_network\_id](#input\_virtual\_network\_id) | The name of the virtual network | `string` | `null` | no |

## Outputs

| Name | Description |
|------|-------------|
| <a name="output_custom_domain_verification_id"></a> [custom\_domain\_verification\_id](#output\_custom\_domain\_verification\_id) | An identifier used by App Service to perform domain ownership verification via DNS TXT record. |
| <a name="output_default_site_hostname"></a> [default\_site\_hostname](#output\_default\_site\_hostname) | The Default Hostname associated with the App Service - such as mysite.azurewebsites.net |
| <a name="output_id"></a> [id](#output\_id) | The ID of the App Service. |
| <a name="output_maximum_number_of_workers"></a> [maximum\_number\_of\_workers](#output\_maximum\_number\_of\_workers) | The maximum number of workers supported with the App Service Plan's sku. |
| <a name="output_outbound_ip_address_list"></a> [outbound\_ip\_address\_list](#output\_outbound\_ip\_address\_list) | A list of outbound IP addresses - such as ['52.23.25.3', '52.143.43.12'] |
| <a name="output_outbound_ip_addresses"></a> [outbound\_ip\_addresses](#output\_outbound\_ip\_addresses) | A comma separated list of outbound IP addresses - such as 52.23.25.3,52.143.43.12 |
| <a name="output_possible_outbound_ip_address_list"></a> [possible\_outbound\_ip\_address\_list](#output\_possible\_outbound\_ip\_address\_list) | A list of outbound IP addresses - such as ['52.23.25.3', '52.143.43.12', '52.143.43.17'] - not all of which are necessarily in use. Superset of outbound\_ip\_address\_list |
| <a name="output_possible_outbound_ip_addresses"></a> [possible\_outbound\_ip\_addresses](#output\_possible\_outbound\_ip\_addresses) | A comma separated list of outbound IP addresses - such as 52.23.25.3,52.143.43.12,52.143.43.17 - not all of which are necessarily in use. Superset of outbound\_ip\_addresses |
| <a name="output_service_plan_id"></a> [service\_plan\_id](#output\_service\_plan\_id) | The ID of the App Service Plan component. |
| <a name="output_site_credential"></a> [site\_credential](#output\_site\_credential) | A site\_credential block as defined below, which contains the site-level credentials used to publish to this App Service. |
| <a name="output_source_control"></a> [source\_control](#output\_source\_control) | A source\_control block as defined below, which contains the Source Control information when scm\_type is set to LocalGit. |
<!-- END_TF_DOCS -->